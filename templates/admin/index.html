{% extends "admin/base_site.html" %}
{% load i18n admin_urls admin_modify log %}
{% load i18n %}

{% load i18n admin_urls static %}

{% block content %}
{% block content_title %}
<div class="admin-dashboard-header">
    <h1>Administración del sitio</h1>
    <p class="text-muted">Bienvenido al panel de administración.</p>
</div>
{% endblock %}

<div class="admin-dashboard">
    <!-- Quick Stats Section Removed - User requested to hide the model statistics -->

    <!-- Recent Actions -->
    {% if user.is_staff %}
        <div class="admin-recent-actions">
            <h2>Acciones recientes</h2>
            {% load log %}
            {% get_admin_log 10 as admin_log for_user user %}
            {% if admin_log %}
                <table class="admin-log-table">
                    <thead>
                        <tr>
                            <th>Hora</th>
                            <th>Acción</th>
                            <th>Usuario</th>
                            <th>Objeto</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in admin_log %}
                            <tr>
                                <td>{{ entry.action_time|date:"M j, Y g:i A" }}</td>
                                <td>
                                    {% if entry.is_addition %}
                                        <span class="badge-action addition">
                                            <i class="fas fa-plus"></i> Agregado
                                        </span>
                                    {% elif entry.is_change %}
                                        <span class="badge-action change">
                                            <i class="fas fa-edit"></i> Modificado
                                        </span>
                                    {% elif entry.is_deletion %}
                                        <span class="badge-action deletion">
                                            <i class="fas fa-trash"></i> Eliminado
                                        </span>
                                    {% endif %}
                                </td>
                                <td>{{ entry.user.get_full_name|default:entry.user.username }}</td>
                                <td>
                                    {% if entry.object_repr %}
                                        "{{ entry.object_repr }}"
                                    {% else %}
                                        Objeto
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p class="no-actions">No hay acciones recientes.</p>
            {% endif %}
        </div>
    {% endif %}

    <!-- App Modules -->
    <div class="admin-apps-grid">
        {% for app in app_list %}
            <div class="admin-app-module">
                <h2>
                    {% if app.app_label == 'auth' %}
                        Autenticación y Autorización
                    {% elif app.app_label == 'contenttypes' %}
                        Tipos de Contenido
                    {% elif app.app_label == 'sessions' %}
                        Sesiones
                    {% elif app.app_label == 'admin' %}
                        Administración
                    {% elif app.app_label == 'messages' %}
                        Mensajes
                    {% else %}
                        {{ app.name }}
                    {% endif %}
                </h2>
                <div class="app-models">
                    {% for model in app.models %}
                        <div class="model-item">
                            <a href="{{ model.admin_url }}" class="model-link">
                                <div class="model-icon">
                                    <i class="fas fa-cube"></i>
                                </div>
                                <div class="model-info">
                                    <h4>
                                        {% if model.object_name == 'Group' %}
                                            Grupos
                                        {% else %}
                                            {{ model.name }}
                                        {% endif %}
                                    </h4>
                                    <p>{{ model.object_count }}
                                        {% if model.object_name == 'Group' %}
                                            {% if model.object_count == 1 %}Grupo{% else %}Grupos{% endif %}
                                        {% else %}
                                            {% if model.object_count == 1 %}{{ model.name }}{% else %}{{ model.name_plural|default:model.name }}s{% endif %}
                                        {% endif %}
                                    </p>
                                </div>
                            </a>
                            <div class="model-actions">
                                <a href="{{ model.admin_url }}add/" class="btn-action-add" title="Agregar {{ model.name }}">
                                    <i class="fas fa-plus"></i>
                                </a>
                                <a href="{{ model.admin_url }}" class="btn-action-list" title="Ver lista de {{ model.name }}">
                                    <i class="fas fa-list"></i>
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}