{% extends 'base.html' %}
{% block title %}Responder a Notificación{% endblock %}
{% block content %}
<div class="container mt-5">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white">
            <h4>Responder Notificación</h4>
        </div>
        <div class="card-body">
            <h5 class="mb-3">{{ notificacion.titulo }}</h5>
            <p class="text-muted">{{ notificacion.mensaje }}</p>
            {% if ya_respondio %}
                <div class="alert alert-warning mb-4">
                    Ya has respondido a esta respuesta.<br>
                    <strong>Tu respuesta:</strong> {{ respuesta_admin.mensaje }}<br>
                    {% if respuesta_admin.documento %}
                        <strong>Documento:</strong> <a href="{{ respuesta_admin.documento.url }}" target="_blank">Descargar</a><br>
                    {% endif %}
                </div>
                <div class="mb-3 d-flex gap-2">
                    <a href="{% url 'notificaciones:responder' notificacion.id %}?otra=1" class="btn btn-success">Agregar otra respuesta</a>
                    <a href="{% url 'notificaciones:modificar_respuesta' respuesta_admin.id %}" class="btn btn-warning">Modificar respuesta</a>
                </div>
            {% else %}
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="id_mensaje" class="form-label">Mensaje breve</label>
                        {{ form.mensaje }}
                    </div>
                    <div class="mb-3">
                        <label for="id_documento" class="form-label">Documento (opcional)</label>
                        {{ form.documento }}
                    </div>
                    <button type="submit" class="btn btn-success">Enviar respuesta</button>
                    <a href="{% url 'notificaciones:index' %}" class="btn btn-secondary ms-2">Cancelar</a>
                </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
